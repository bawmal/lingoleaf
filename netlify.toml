[functions]
  node_bundler = "esbuild"
  included_files = ["netlify/functions/lib/**"]
  external_node_modules = ["node-fetch","twilio"]

[build.environment]
  NODE_VERSION = "18"

[context.dev.environment]
  OPENAI_API_KEY = "YOUR_OPENAI_API_KEY_HERE"

[[headers]]
  for = "/*"
  [headers.values]
  X-Frame-Options = "DENY"
  X-Content-Type-Options = "nosniff"
  X-XSS-Protection = "1; mode=block"
  Referrer-Policy = "strict-origin-when-cross-origin"
  Content-Security-Policy = "frame-ancestors 'none'"

[[headers]]
  for = "/success.html"
  [headers.values]
  Cache-Control = "no-store"

[[headers]]
  for = "/js/*"
  [headers.values]
  Cache-Control = "public, max-age=0, must-revalidate"

# Scheduled job: every hour
[[scheduled.functions]]
  name = "schedule-check"
  cron = "0 * * * *"

# Scheduled job: check trial expiry daily at 9am UTC
[[scheduled.functions]]
  name = "check-trial-expiry"
  cron = "0 9 * * *"
